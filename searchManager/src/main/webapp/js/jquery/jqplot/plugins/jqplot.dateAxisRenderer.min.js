/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.0b2_r1012
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 * 
 */(function(a){function m(a,b,c){var d=Number.MAX_VALUE,e,f,g;for(var h=0,i=k.length;h<i;h++)e=Math.abs(c-k[h]),e<d&&(d=e,f=k[h],g=j[h]);return[f,g]}a.jqplot.DateAxisRenderer=function(){a.jqplot.LinearAxisRenderer.call(this),this.date=new a.jsDate};var b=1e3,c=60*b,d=60*c,e=24*d,f=7*e,g=30.4368499*e,h=365.242199*e,i=[31,28,31,30,31,30,31,30,31,30,31,30],j=["%M:%S.%#N","%M:%S.%#N","%M:%S.%#N","%M:%S","%M:%S","%M:%S","%M:%S","%H:%M:%S","%H:%M:%S","%H:%M","%H:%M","%H:%M","%H:%M","%H:%M","%H:%M","%a %H:%M","%a %H:%M","%b %e %H:%M","%b %e %H:%M","%b %e %H:%M","%b %e %H:%M","%v","%v","%v","%v","%v","%v","%v"],k=[.1*b,.2*b,.5*b,b,2*b,5*b,10*b,15*b,30*b,c,2*c,5*c,10*c,15*c,30*c,d,2*d,4*d,6*d,8*d,12*d,e,2*e,3*e,4*e,5*e,f,2*f],l=[];a.jqplot.DateAxisRenderer.prototype=new a.jqplot.LinearAxisRenderer,a.jqplot.DateAxisRenderer.prototype.constructor=a.jqplot.DateAxisRenderer,a.jqplot.DateTickFormatter=function(b,c){return b||(b="%Y/%m/%d"),a.jsDate.strftime(c,b)},a.jqplot.DateAxisRenderer.prototype.init=function(b){this.tickOptions.formatter=a.jqplot.DateTickFormatter,this.tickInset=0,this.drawBaseline=!0,this.baselineWidth=null,this.baselineColor=null,this.daTickInterval=null,this._daTickInterval=null,a.extend(!0,this,b);var c=this._dataBounds,d,e,f,g,h,i,j;for(var k=0;k<this._series.length;k++){d={intervals:[],frequencies:{},sortedIntervals:[],min:null,max:null,mean:null},e=0,f=this._series[k],g=f.data,h=f._plotData,i=f._stackData,j=0;for(var l=0;l<g.length;l++){if(this.name=="xaxis"||this.name=="x2axis"){g[l][0]=(new a.jsDate(g[l][0])).getTime(),h[l][0]=(new a.jsDate(g[l][0])).getTime(),i[l][0]=(new a.jsDate(g[l][0])).getTime();if(g[l][0]!=null&&g[l][0]<c.min||c.min==null)c.min=g[l][0];if(g[l][0]!=null&&g[l][0]>c.max||c.max==null)c.max=g[l][0];l>0&&(j=Math.abs(g[l][0]-g[l-1][0]),d.intervals.push(j),d.frequencies.hasOwnProperty(j)?d.frequencies[j]+=1:d.frequencies[j]=1),e+=j}else{g[l][1]=(new a.jsDate(g[l][1])).getTime(),h[l][1]=(new a.jsDate(g[l][1])).getTime(),i[l][1]=(new a.jsDate(g[l][1])).getTime();if(g[l][1]!=null&&g[l][1]<c.min||c.min==null)c.min=g[l][1];if(g[l][1]!=null&&g[l][1]>c.max||c.max==null)c.max=g[l][1];l>0&&(j=Math.abs(g[l][1]-g[l-1][1]),d.intervals.push(j),d.frequencies.hasOwnProperty(j)?d.frequencies[j]+=1:d.frequencies[j]=1)}e+=j}if(f.renderer.bands){if(f.renderer.bands.hiData.length){var m=f.renderer.bands.hiData;for(var l=0,n=m.length;l<n;l++)if(this.name==="xaxis"||this.name==="x2axis"){m[l][0]=(new a.jsDate(m[l][0])).getTime();if(m[l][0]!=null&&m[l][0]>c.max||c.max==null)c.max=m[l][0]}else{m[l][1]=(new a.jsDate(m[l][1])).getTime();if(m[l][1]!=null&&m[l][1]>c.max||c.max==null)c.max=m[l][1]}}if(f.renderer.bands.lowData.length){var m=f.renderer.bands.lowData;for(var l=0,n=m.length;l<n;l++)if(this.name==="xaxis"||this.name==="x2axis"){m[l][0]=(new a.jsDate(m[l][0])).getTime();if(m[l][0]!=null&&m[l][0]<c.min||c.min==null)c.min=m[l][0]}else{m[l][1]=(new a.jsDate(m[l][1])).getTime();if(m[l][1]!=null&&m[l][1]<c.min||c.min==null)c.min=m[l][1]}}}var o=0,p=0;for(var q in d.frequencies)d.sortedIntervals.push({interval:q,frequency:d.frequencies[q]});d.sortedIntervals.sort(function(a,b){return b.frequency-a.frequency}),d.min=a.jqplot.arrayMin(d.intervals),d.max=a.jqplot.arrayMax(d.intervals),d.mean=e/g.length,this._intervalStats.push(d),d=e=f=g=h=i=null}c=null},a.jqplot.DateAxisRenderer.prototype.reset=function(){this.min=this._options.min,this.max=this._options.max,this.tickInterval=this._options.tickInterval,this.numberTicks=this._options.numberTicks,this._autoFormatString="",this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString&&(this.tickOptions.formatString=""),this.daTickInterval=this._daTickInterval},a.jqplot.DateAxisRenderer.prototype.createTicks=function(b){var c=this._ticks,d=this.ticks,f=this.name,i=this._dataBounds,j=this._intervalStats,k=this.name.charAt(0)==="x"?this._plotDimensions.width:this._plotDimensions.height,l,n,o,p,q,r,s,t=30,u=1,v=this.tickInterval;n=this.min!=null?(new a.jsDate(this.min)).getTime():i.min,o=this.max!=null?(new a.jsDate(this.max)).getTime():i.max;var w=b.plugins.cursor;w&&w._zoom&&w._zoom.zooming&&(this.min=null,this.max=null);var x=o-n;if(this.tickOptions==null||!this.tickOptions.formatString)this._overrideFormatString=!0;if(d.length){for(s=0;s<d.length;s++){var y=d[s],z=new this.tickRenderer(this.tickOptions);y.constructor==Array?(z.value=(new a.jsDate(y[0])).getTime(),z.label=y[1],this.showTicks?this.showTickMarks||(z.showMark=!1):(z.showLabel=!1,z.showMark=!1),z.setTick(z.value,this.name),this._ticks.push(z)):(z.value=(new a.jsDate(y)).getTime(),this.showTicks?this.showTickMarks||(z.showMark=!1):(z.showLabel=!1,z.showMark=!1),z.setTick(z.value,this.name),this._ticks.push(z))}this.numberTicks=d.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.daTickInterval=[(this.max-this.min)/(this.numberTicks-1)/1e3,"seconds"]}else if(this.min==null&&this.max==null&&i.min==i.max){var A=a.extend(!0,{},this.tickOptions,{name:this.name,value:null}),B=3e5;this.min=i.min-B,this.max=i.max+B,this.numberTicks=3;for(var s=this.min;s<=this.max;s+=B){A.value=s;var z=new this.tickRenderer(A);this._overrideFormatString&&this._autoFormatString!=""&&(z.formatString=this._autoFormatString),z.showLabel=!1,z.showMark=!1,this._ticks.push(z)}this.showTicks&&(this._ticks[1].showLabel=!0),this.showTickMarks&&(this._ticks[1].showTickMarks=!0)}else if(this.min==null&&this.max==null){var C=a.extend(!0,{},this.tickOptions,{name:this.name,value:null}),D,E;if(!this.tickInterval&&!this.numberTicks){var F=Math.max(k,t+1),G=115;this.tickRenderer===a.jqplot.CanvasAxisTickRenderer&&this.tickOptions.angle&&(G=115-40*Math.abs(Math.sin(this.tickOptions.angle/180*Math.PI))),D=Math.ceil((F-t)/G+1),E=(o-n)/(D-1)}else this.tickInterval?E=this.tickInterval:this.numberTicks&&(D=this.numberTicks,E=(o-n)/(D-1));if(E<=19*e){var H=m(n,o,E),I=H[0];this._autoFormatString=H[1],n=Math.floor(n/I)*I,n=new a.jsDate(n),n=n.getTime()+n.getUtcOffset(),D=Math.ceil((o-n)/I)+1,this.min=n,this.max=n+(D-1)*I,this.max<o&&(this.max+=I,D+=1),this.tickInterval=I,this.numberTicks=D;for(var s=0;s<D;s++)C.value=this.min+s*I,z=new this.tickRenderer(C),this._overrideFormatString&&this._autoFormatString!=""&&(z.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(z.showMark=!1):(z.showLabel=!1,z.showMark=!1),this._ticks.push(z);u=this.tickInterval}else if(E<=9*g){this._autoFormatString="%v";var J=Math.round(E/g);J<1?J=1:J>6&&(J=6);var K=(new a.jsDate(n)).setDate(1).setHours(0,0,0,0),L=new a.jsDate(o),M=(new a.jsDate(o)).setDate(1).setHours(0,0,0,0);L.getTime()!==M.getTime()&&(M=M.add(1,"month"));var N=M.diff(K,"month");D=Math.ceil(N/J)+1,this.min=K.getTime(),this.max=K.clone().add((D-1)*J,"month").getTime(),this.numberTicks=D;for(var s=0;s<D;s++)s===0?C.value=K.getTime():C.value=K.add(J,"month").getTime(),z=new this.tickRenderer(C),this._overrideFormatString&&this._autoFormatString!=""&&(z.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(z.showMark=!1):(z.showLabel=!1,z.showMark=!1),this._ticks.push(z);u=J*g}else{this._autoFormatString="%v";var J=Math.round(E/h);J<1&&(J=1);var K=(new a.jsDate(n)).setMonth(0,1).setHours(0,0,0,0),M=(new a.jsDate(o)).add(1,"year").setMonth(0,1).setHours(0,0,0,0),O=M.diff(K,"year");D=Math.ceil(O/J)+1,this.min=K.getTime(),this.max=K.clone().add((D-1)*J,"year").getTime(),this.numberTicks=D;for(var s=0;s<D;s++)s===0?C.value=K.getTime():C.value=K.add(J,"year").getTime(),z=new this.tickRenderer(C),this._overrideFormatString&&this._autoFormatString!=""&&(z.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(z.showMark=!1):(z.showLabel=!1,z.showMark=!1),this._ticks.push(z);u=J*h}}else{f=="xaxis"||f=="x2axis"?k=this._plotDimensions.width:k=this._plotDimensions.height,this.min!=null&&this.max!=null&&this.numberTicks!=null&&(this.tickInterval=null);if(this.tickInterval!=null)if(Number(this.tickInterval))this.daTickInterval=[Number(this.tickInterval),"seconds"];else if(typeof this.tickInterval=="string"){var P=this.tickInterval.split(" ");P.length==1?this.daTickInterval=[1,P[0]]:P.length==2&&(this.daTickInterval=[P[0],P[1]])}if(n==o){var Q=432e5;n-=Q,o+=Q}x=o-n;var R=2+parseInt(Math.max(0,k-100)/100,10),S,T;S=this.min!=null?(new a.jsDate(this.min)).getTime():n-x/2*(this.padMin-1),T=this.max!=null?(new a.jsDate(this.max)).getTime():o+x/2*(this.padMax-1),this.min=S,this.max=T,x=this.max-this.min;if(this.numberTicks==null)if(this.daTickInterval!=null){var U=(new a.jsDate(this.max)).diff(this.min,this.daTickInterval[1],!0);this.numberTicks=Math.ceil(U/this.daTickInterval[0])+1,this.max=(new a.jsDate(this.min)).add((this.numberTicks-1)*this.daTickInterval[0],this.daTickInterval[1]).getTime()}else k>200?this.numberTicks=parseInt(3+(k-200)/100,10):this.numberTicks=2;u=x/(this.numberTicks-1)/1e3,this.daTickInterval==null&&(this.daTickInterval=[u,"seconds"]);for(var s=0;s<this.numberTicks;s++){var n=new a.jsDate(this.min);r=n.add(s*this.daTickInterval[0],this.daTickInterval[1]).getTime();var z=new this.tickRenderer(this.tickOptions);this.showTicks?this.showTickMarks||(z.showMark=!1):(z.showLabel=!1,z.showMark=!1),z.setTick(r,this.name),this._ticks.push(z)}}this.tickInset&&(this.min=this.min-this.tickInset*u,this.max=this.max+this.tickInset*u),this._daTickInterval==null&&(this._daTickInterval=this.daTickInterval),c=null}})(jQuery);